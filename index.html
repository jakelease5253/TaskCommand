<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus Task Manager</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // TODO: Update this with your Azure Static Web App URL after deployment
        const REDIRECT_URI = 'https://blue-sand-0d6d8c00f.3.azurestaticapps.net/';
        
        const MSAL_CONFIG = {
            auth: {
                clientId: '8724797a-a121-4f6c-bc18-2cc72266a686',
                authority: 'https://login.microsoftonline.com/327a958f-68a1-40f6-aada-48a87827f0b1',
                redirectUri: REDIRECT_URI
            }
        };

        const GRAPH_SCOPES = ['Tasks.ReadWrite', 'Group.Read.All', 'User.Read'];

        // Lucide icons as React components
        const Play = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
        );

        const Pause = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
        );

        const Square = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            </svg>
        );

        const Clock = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Calendar = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Target = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="6"></circle>
                <circle cx="12" cy="12" r="2"></circle>
            </svg>
        );

        const RefreshCw = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );

        const LogOut = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
        );

        const AlertCircle = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        function FocusTaskManager() {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [accessToken, setAccessToken] = useState(null);
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            
            const [tasks, setTasks] = useState([]);
            const [focusTask, setFocusTask] = useState(null);
            const [focusStartTime, setFocusStartTime] = useState(null);
            const [focusElapsed, setFocusElapsed] = useState(0);
            
            const [isWorkTimerRunning, setIsWorkTimerRunning] = useState(false);
            const [workStartTime, setWorkStartTime] = useState(null);
            const [workElapsed, setWorkElapsed] = useState(0);

            const generateCodeChallenge = async (codeVerifier) => {
                const encoder = new TextEncoder();
                const data = encoder.encode(codeVerifier);
                const hash = await crypto.subtle.digest('SHA-256', data);
                return btoa(String.fromCharCode(...new Uint8Array(hash)))
                    .replace(/\+/g, '-')
                    .replace(/\//g, '_')
                    .replace(/=/g, '');
            };

            const generateRandomString = (length) => {
                const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                const values = crypto.getRandomValues(new Uint8Array(length));
                return values.reduce((acc, x) => acc + possible[x % possible.length], '');
            };

            const handleLogin = async () => {
                try {
                    setError(null);
                    const codeVerifier = generateRandomString(64);
                    const codeChallenge = await generateCodeChallenge(codeVerifier);
                    
                    sessionStorage.setItem('code_verifier', codeVerifier);
                    
                    const authUrl = `${MSAL_CONFIG.auth.authority}/oauth2/v2.0/authorize?` +
                        `client_id=${MSAL_CONFIG.auth.clientId}` +
                        `&response_type=code` +
                        `&redirect_uri=${encodeURIComponent(MSAL_CONFIG.auth.redirectUri)}` +
                        `&response_mode=query` +
                        `&scope=${encodeURIComponent(GRAPH_SCOPES.join(' '))}` +
                        `&code_challenge=${codeChallenge}` +
                        `&code_challenge_method=S256`;
                    
                    window.location.href = authUrl;
                } catch (err) {
                    setError('Failed to initiate login: ' + err.message);
                }
            };

            const handleAuthCallback = async () => {
                const urlParams = new URLSearchParams(window.location.search);
                const code = urlParams.get('code');
                const errorParam = urlParams.get('error');
                
                if (errorParam) {
                    setError(`Authentication error: ${errorParam}`);
                    return;
                }
                
                if (code) {
                    try {
                        const codeVerifier = sessionStorage.getItem('code_verifier');
                        
                        const tokenResponse = await fetch(`${MSAL_CONFIG.auth.authority}/oauth2/v2.0/token`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                            },
                            body: new URLSearchParams({
                                client_id: MSAL_CONFIG.auth.clientId,
                                scope: GRAPH_SCOPES.join(' '),
                                code: code,
                                redirect_uri: MSAL_CONFIG.auth.redirectUri,
                                grant_type: 'authorization_code',
                                code_verifier: codeVerifier
                            })
                        });
                        
                        const tokenData = await tokenResponse.json();
                        
                        if (tokenData.access_token) {
                            setAccessToken(tokenData.access_token);
                            setIsAuthenticated(true);
                            sessionStorage.removeItem('code_verifier');
                            window.history.replaceState({}, document.title, window.location.pathname);
                            await fetchUserProfile(tokenData.access_token);
                            await fetchPlannerTasks(tokenData.access_token);
                        } else {
                            throw new Error(tokenData.error_description || 'Failed to get access token');
                        }
                    } catch (err) {
                        setError('Failed to complete authentication: ' + err.message);
                    }
                }
            };

            const fetchUserProfile = async (token) => {
                try {
                    const response = await fetch('https://graph.microsoft.com/v1.0/me', {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    const userData = await response.json();
                    setUser(userData);
                } catch (err) {
                    console.error('Failed to fetch user profile:', err);
                }
            };

            const fetchPlannerTasks = async (token) => {
                setLoading(true);
                setError(null);
                
                try {
                    const userResponse = await fetch('https://graph.microsoft.com/v1.0/me', {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    const userData = await userResponse.json();
                    
                    const tasksResponse = await fetch(
                        `https://graph.microsoft.com/v1.0/me/planner/tasks`,
                        {
                            headers: { 'Authorization': `Bearer ${token}` }
                        }
                    );
                    
                    if (!tasksResponse.ok) {
                        throw new Error(`Failed to fetch tasks: ${tasksResponse.statusText}`);
                    }
                    
                    const tasksData = await tasksResponse.json();
                    
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    const sevenDaysFromNow = new Date(today);
                    sevenDaysFromNow.setDate(sevenDaysFromNow.getDate() + 7);
                    
                    const filteredTasks = tasksData.value
                        .filter(task => {
                            if (!task.dueDateTime) return false;
                            if (task.percentComplete === 100) return false;
                            const dueDate = new Date(task.dueDateTime);
                            return dueDate <= sevenDaysFromNow;
                        })
                        .map(task => ({
                            id: task.id,
                            title: task.title,
                            description: task.percentComplete > 0 ? `${task.percentComplete}% complete` : 'Not started',
                            dueDate: task.dueDateTime.split('T')[0],
                            priority: task.priority <= 3 ? 'high' : task.priority <= 6 ? 'medium' : 'low',
                            percentComplete: task.percentComplete,
                            planId: task.planId,
                            bucketId: task.bucketId,
                            totalFocusTime: 0,
                            totalActiveTime: 0,
                            focusHistory: [],
                            workHistory: []
                        }))
                        .sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
                    
                    setTasks(filteredTasks);
                    
                } catch (err) {
                    setError('Failed to load tasks from Planner: ' + err.message);
                    console.error('Error fetching tasks:', err);
                } finally {
                    setLoading(false);
                }
            };

            const handleRefresh = () => {
                if (accessToken) {
                    fetchPlannerTasks(accessToken);
                }
            };

            const handleLogout = () => {
                setIsAuthenticated(false);
                setAccessToken(null);
                setUser(null);
                setTasks([]);
                setFocusTask(null);
                sessionStorage.clear();
            };

            useEffect(() => {
                handleAuthCallback();
            }, []);

            useEffect(() => {
                if (focusTask && focusStartTime) {
                    const interval = setInterval(() => {
                        setFocusElapsed(Math.floor((Date.now() - focusStartTime) / 1000));
                    }, 1000);
                    return () => clearInterval(interval);
                }
            }, [focusTask, focusStartTime]);

            useEffect(() => {
                if (isWorkTimerRunning && workStartTime) {
                    const interval = setInterval(() => {
                        setWorkElapsed(Math.floor((Date.now() - workStartTime) / 1000));
                    }, 1000);
                    return () => clearInterval(interval);
                }
            }, [isWorkTimerRunning, workStartTime]);

            const handleSetFocus = (task) => {
                if (focusTask) {
                    const endTime = Date.now();
                    const duration = focusElapsed;
                    
                    setTasks(prev => prev.map(t => {
                        if (t.id === focusTask.id) {
                            return {
                                ...t,
                                totalFocusTime: t.totalFocusTime + duration,
                                focusHistory: [...t.focusHistory, {
                                    startTime: focusStartTime,
                                    endTime,
                                    duration
                                }]
                            };
                        }
                        return t;
                    }));
                }

                if (isWorkTimerRunning) {
                    handleStopWork();
                }

                const newFocusTask = tasks.find(t => t.id === task.id);
                setFocusTask(newFocusTask);
                setFocusStartTime(Date.now());
                setFocusElapsed(0);
                setWorkElapsed(0);
            };

            const handleStartWork = () => {
                setIsWorkTimerRunning(true);
                setWorkStartTime(Date.now());
            };

            const handlePauseWork = () => {
                if (isWorkTimerRunning) {
                    const endTime = Date.now();
                    const duration = workElapsed;
                    
                    setTasks(prev => prev.map(t => {
                        if (t.id === focusTask.id) {
                            return {
                                ...t,
                                totalActiveTime: t.totalActiveTime + duration,
                                workHistory: [...t.workHistory, {
                                    startTime: workStartTime,
                                    endTime,
                                    duration
                                }]
                            };
                        }
                        return t;
                    }));

                    setIsWorkTimerRunning(false);
                    setWorkStartTime(null);
                    setWorkElapsed(0);
                }
            };

            const handleStopWork = () => {
                handlePauseWork();
            };

            const formatTime = (seconds) => {
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                const s = seconds % 60;
                return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            };

            const formatDate = (dateString) => {
                const date = new Date(dateString);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                const taskDate = new Date(date);
                taskDate.setHours(0, 0, 0, 0);
                
                if (taskDate < today) return 'Overdue';
                if (taskDate.getTime() === today.getTime()) return 'Today';
                if (taskDate.getTime() === tomorrow.getTime()) return 'Tomorrow';
                
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            };

            const getPriorityColor = (priority) => {
                switch(priority) {
                    case 'high': return 'text-red-600 bg-red-50';
                    case 'medium': return 'text-amber-600 bg-amber-50';
                    case 'low': return 'text-blue-600 bg-blue-50';
                    default: return 'text-gray-600 bg-gray-50';
                }
            };

            const getDateColor = (dateString) => {
                const date = new Date(dateString);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const taskDate = new Date(date);
                taskDate.setHours(0, 0, 0, 0);
                
                if (taskDate < today) return 'text-red-600';
                if (taskDate.getTime() === today.getTime()) return 'text-amber-600';
                return 'text-slate-500';
            };

            if (!isAuthenticated) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-8">
                        <div className="bg-white rounded-2xl shadow-lg p-12 max-w-md w-full border border-slate-200">
                            <div className="w-16 h-16 mx-auto mb-6 flex items-center justify-center">
                                <Target />
                            </div>
                            <h1 className="text-3xl font-light text-slate-800 text-center mb-3">Focus Task Manager</h1>
                            <p className="text-slate-600 text-center mb-8">
                                Connect to Microsoft Planner to track your tasks and stay focused on what matters.
                            </p>
                            {error && (
                                <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-start gap-3">
                                    <div className="flex-shrink-0 mt-0.5">
                                        <AlertCircle />
                                    </div>
                                    <p className="text-sm text-red-800">{error}</p>
                                </div>
                            )}
                            <button
                                onClick={handleLogin}
                                className="w-full bg-indigo-600 text-white px-6 py-4 rounded-xl hover:bg-indigo-700 transition-colors font-medium"
                            >
                                Sign in with Microsoft
                            </button>
                        </div>
                    </div>
                );
            }

            const currentFocusTask = focusTask ? tasks.find(t => t.id === focusTask.id) : null;
            const upcomingTasks = tasks.filter(t => !focusTask || t.id !== focusTask.id);

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-8">
                    <div className="max-w-7xl mx-auto">
                        <header className="mb-8 flex items-center justify-between">
                            <div>
                                <h1 className="text-3xl font-light text-slate-800">Focus</h1>
                                <p className="text-slate-500 mt-1">Stay present. Work intentionally.</p>
                            </div>
                            <div className="flex items-center gap-3">
                                {user && (
                                    <span className="text-sm text-slate-600">
                                        {user.displayName || user.userPrincipalName}
                                    </span>
                                )}
                                <button
                                    onClick={handleRefresh}
                                    disabled={loading}
                                    className="flex items-center gap-2 px-4 py-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 transition-colors text-sm font-medium text-slate-700"
                                >
                                    <RefreshCw className={loading ? 'animate-spin' : ''} />
                                    Refresh
                                </button>
                                <button
                                    onClick={handleLogout}
                                    className="flex items-center gap-2 px-4 py-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 transition-colors text-sm font-medium text-slate-700"
                                >
                                    <LogOut />
                                    Sign Out
                                </button>
                            </div>
                        </header>

                        {error && (
                            <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-start gap-3">
                                <div className="flex-shrink-0 mt-0.5">
                                    <AlertCircle />
                                </div>
                                <p className="text-sm text-red-800">{error}</p>
                            </div>
                        )}

                        {loading ? (
                            <div className="text-center py-12">
                                <RefreshCw className="w-8 h-8 text-indigo-600 animate-spin mx-auto mb-4" />
                                <p className="text-slate-600">Loading your tasks from Microsoft Planner...</p>
                            </div>
                        ) : tasks.length === 0 ? (
                            <div className="bg-white rounded-2xl shadow-lg p-12 border border-slate-200 text-center">
                                <div className="w-16 h-16 mx-auto mb-4 flex items-center justify-center text-slate-300">
                                    <Target />
                                </div>
                                <h2 className="text-2xl font-light text-slate-400 mb-2">No tasks found</h2>
                                <p className="text-slate-500">You don't have any tasks due in the next 7 days.</p>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <div className="lg:col-span-2">
                                    {currentFocusTask ? (
                                        <div className="bg-white rounded-2xl shadow-lg p-8 border border-slate-200">
                                            <div className="flex items-start justify-between mb-6">
                                                <div className="flex-1">
                                                    <div className="flex items-center gap-3 mb-3">
                                                        <div className="w-6 h-6 text-indigo-600">
                                                            <Target />
                                                        </div>
                                                        <span className="text-sm font-medium text-indigo-600 uppercase tracking-wide">Current Focus</span>
                                                    </div>
                                                    <h2 className="text-3xl font-light text-slate-800 mb-2">{currentFocusTask.title}</h2>
                                                    <p className="text-slate-600 leading-relaxed">{currentFocusTask.description}</p>
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <span className={`px-3 py-1 rounded-full text-xs font-medium ${getPriorityColor(currentFocusTask.priority)}`}>
                                                        {currentFocusTask.priority}
                                                    </span>
                                                    <span className={`flex items-center gap-1 text-sm font-medium ${getDateColor(currentFocusTask.dueDate)}`}>
                                                        <div className="w-4 h-4">
                                                            <Calendar />
                                                        </div>
                                                        {formatDate(currentFocusTask.dueDate)}
                                                    </span>
                                                </div>
                                            </div>

                                            <div className="grid grid-cols-2 gap-4 mb-8">
                                                <div className="bg-indigo-50 rounded-xl p-6">
                                                    <div className="flex items-center gap-2 mb-2">
                                                        <div className="w-5 h-5 text-indigo-600">
                                                            <Clock />
                                                        </div>
                                                        <span className="text-sm font-medium text-indigo-900">Focus Time</span>
                                                    </div>
                                                    <div className="text-4xl font-light text-indigo-600 mb-1">
                                                        {formatTime(currentFocusTask.totalFocusTime + focusElapsed)}
                                                    </div>
                                                    <p className="text-xs text-indigo-600 opacity-70">Auto-tracked since focus</p>
                                                </div>

                                                <div className="bg-emerald-50 rounded-xl p-6">
                                                    <div className="flex items-center gap-2 mb-2">
                                                        <div className="w-5 h-5 text-emerald-600">
                                                            <Play />
                                                        </div>
                                                        <span className="text-sm font-medium text-emerald-900">Active Work</span>
                                                    </div>
                                                    <div className="text-4xl font-light text-emerald-600 mb-1">
                                                        {formatTime(currentFocusTask.totalActiveTime + workElapsed)}
                                                    </div>
                                                    <p className="text-xs text-emerald-600 opacity-70">Manual timer sessions</p>
                                                </div>
                                            </div>

                                            <div className="flex gap-3">
                                                {!isWorkTimerRunning ? (
                                                    <button
                                                        onClick={handleStartWork}
                                                        className="flex-1 flex items-center justify-center gap-2 bg-emerald-600 text-white px-6 py-4 rounded-xl hover:bg-emerald-700 transition-colors font-medium"
                                                    >
                                                        <div className="w-5 h-5">
                                                            <Play />
                                                        </div>
                                                        Start Work Timer
                                                    </button>
                                                ) : (
                                                    <>
                                                        <button
                                                            onClick={handlePauseWork}
                                                            className="flex-1 flex items-center justify-center gap-2 bg-amber-600 text-white px-6 py-4 rounded-xl hover:bg-amber-700 transition-colors font-medium"
                                                        >
                                                            <div className="w-5 h-5">
                                                                <Pause />
                                                            </div>
                                                            Pause
                                                        </button>
                                                        <button
                                                            onClick={handleStopWork}
                                                            className="flex-1 flex items-center justify-center gap-2 bg-slate-600 text-white px-6 py-4 rounded-xl hover:bg-slate-700 transition-colors font-medium"
                                                        >
                                                            <div className="w-5 h-5">
                                                                <Square />
                                                            </div>
                                                            Stop
                                                        </button>
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="bg-white rounded-2xl shadow-lg p-12 border border-slate-200 text-center">
                                            <div className="w-16 h-16 mx-auto mb-4 flex items-center justify-center text-slate-300">
                                                <Target />
                                            </div>
                                            <h2 className="text-2xl font-light text-slate-400 mb-2">No task in focus</h2>
                                            <p className="text-slate-500">Select a task from your upcoming list to begin</p>
                                        </div>
                                    )}
                                </div>

                                <div className="lg:col-span-1">
                                    <div className="bg-white rounded-2xl shadow-lg p-6 border border-slate-200">
                                        <h3 className="text-lg font-medium text-slate-800 mb-4">
                                            Upcoming Tasks ({upcomingTasks.length})
                                        </h3>
                                        <div className="space-y-3">
                                            {upcomingTasks.map(task => (
                                                <button
                                                    key={task.id}
                                                    onClick={() => handleSetFocus(task)}
                                                    className="w-full text-left p-4 rounded-xl border border-slate-200 hover:border-indigo-300 hover:bg-indigo-50 transition-all group"
                                                >
                                                    <div className="flex items-start justify-between mb-2">
                                                        <h4 className="font-medium text-slate-800 group-hover:text-indigo-900 flex-1 pr-2">
                                                            {task.title}
                                                        </h4>
                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPriorityColor(task.priority)}`}>
                                                            {task.priority}
                                                        </span>
                                                    </div>
                                                    <div className="flex items-center gap-3 text-xs">
                                                        <span className={`flex items-center gap-1 font-medium ${getDateColor(task.dueDate)}`}>
                                                            <div className="w-3 h-3">
                                                                <Calendar />
                                                            </div>
                                                            {formatDate(task.dueDate)}
                                                        </span>
                                                        {task.totalFocusTime > 0 && (
                                                            <span className="flex items-center gap-1 text-slate-500">
                                                                <div className="w-3 h-3">
                                                                    <Clock />
                                                                </div>
                                                                {formatTime(task.totalFocusTime)}
                                                            </span>
                                                        )}
                                                    </div>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FocusTaskManager />);
    </script>
</body>
</html>
